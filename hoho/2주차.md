# Http 기본, 메서드

## HTTP 기본

### Http 시대!

모든 형태의 데이터를 전송할 수 있다.

서버간 데이터를 주고받을 때도 대부분 http를 사용

이미지, 음성, 영상, 파일, json, xml 모두 전송 가능

HTTP/1.1 버전이 가장 많이 사용하고 2,3 버전은 성능이 개선되기 때문에 1.1을 잘 학습해야 한다.

### 클라이언트 서버 구조

요청, 응답의 구조

클라이언트는 서버에 요청을 보내고 응답을 대기


양쪽이 독립적으로 진화가 가능

클라이언트는 UI에 집중할 수 있다.

### 무상태 프로토콜

서버가 클라이언트의 상태를 보존하지 않는다.

→ 서버는 이전 요청에 대한 정보를 보관하지 않는다.

Stateful (상태 유지) : 서버가 계속 이전 요청에 대한 응답을 가지고 있어야 한다.

Stateless (무상태) : 이전 요청을 알지 못 해도 된다.

요청이 증가해도 서버를 많이 투입할 수 있다.

무상태는 응답 서버를 쉽게 변경할 수 있다. → 무한한 서버 증설 가능

**실무적인 한계**

- 모든 것을 무상태로 설계할 수 있는 경우도 있고 없는 경우도 있다.
- 로그인의 경우 로그인의 상태를 서버에서 유지해야한다.
- 일반적으로 쿠키와 서버 세션등을 사용해 상태 유지
- 상태 유지는 최소한만 사용

### 비연결성

연결을 유지하지 않는다. → 최소한의 자원을 사용할 수 있다.

HTTP는 기본이 연결을 유지하지 않는다.

초단위 이하의 빠른 속도로 응답

수천명이 서비스를 사용해도 실제 서버에서 동시에 처리하는 요청은 수십개 이하로 작음

서버 자원을 효율적으로 사용할 수 있다.

**한계 및 극복**

- TCP/IP 연결을 새로 맺어야 한다. 3 way handshake 시간 추가
- js, css, 이미지등 많은 자원이 함께 다운로드
- HTTP 지속 연결로 문제 해결 (Persistent Conections)
- HTTP/2, HTTP/3에서는 더 최적화

### HTTP 메시지 구조

![공백라인은 무조건 필요함!](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/a434a907-8cc6-4225-937a-9987fbea9ad9/스크린샷_2022-05-08_오후_9.49.01.png)

공백라인은 무조건 필요함!

- 시작라인
    - 요청 메시지 - 요청 대상
        - start-line : **request-line** / status-line
        - request-line : method SP(공백) request-tartget SP HTTP -version CRLF(엔터)
        - HTTP 메서드
        - 요청 대상 (/search?q=hello&hl=ko)
        - HTTP Version
    - 응답 메시지
        - start-line : request-line / **status-line**
        - status-line : HTTP-vserion SP status-code SP reason-phrase CRLF
        - HTTP 버전
        - HTTP 상태 코드 : 요청 성공, 실패를 나타낸다.
            - 200: ok
            - 400: bad request
            - 500: server error
        - 이유 문구 : 사람이 이해할 수 있는 짧은 상태 코드 설명 글
- HTTP 헤더
    - header-field = field-name “:” OWS field-value OWS
        - Host : ← 이거 안됨
    - HTTP 전송에 필요한 모든 부가정보
        - 바디가 어떤 정보인지, 바디의 크기, 인증 정보, 웹 정보, 캐시 정보 등
    - 필요시 임의의 헤더 추가 가능
- HTTP 메시지 바디
    - 실제 전송할 데이터
    - HTML, 이미지, 영상 등 바이트로 표현할 수 있는 모든 데이터 전송 가능

HTTP는 단순하고 확장 가능하다!!

---

## HTTP 메서드

### 리소스는 뭘까?

- 회원을 등록하고 조회하는게 리소스가 아니다.
- 회원이라는 개념 자체가 리소스
- 회원이라는 리소스만 식별하면 된다.

### URI 설계

리소스 식별, URI 계층 구조 활용

- 회원 목록 조회 /members
- 회원 조회 /members/{id}
- 회원 등록 /members/{id}
- 회원 수정 /members/{id}
- 회원 삭제 /members/{id}

어떻게 구분하는가? → 리소스와 행위를 분리한다.

리소스 : 회원

행위 : 조회, 등록, 삭제, 변경 → HTTP 메서드

HTTP 메서드 종류

GET, POST, PUT, PATCH, DELETE, 기타...(HEAD, OPTIONS, CONNECT, TRACE)

### GET

- 리소스 조회
- 서버에 전달하는 데이터는 쿼리를 통해 전달
- 바디를 사용하는 것은 권장하지 않는다. (지원하는 서버가 많지 않다.)

### POST

- 요청 데이터 처리
- 바디를 통해 서버로 요청 데이터 전달
- 서버는 요청 데이터를 처리 (바디로 들어온 데이터를 처리하는 모든 기능 수행)
- 신규 리소스 등록, 프로세스 처리에 사용
- 스펙 : **대상 리소스가 리소스의 고유한 의미 체계에 따라 요청에 포함된 표현을 처리하도록 요청**
- HTML 양식에 입력된 필드와 같은 데이터 블록을 데이터 처리 프로세스에 제공
    - 회원가입, 주문
- 글쓰기, 댓글쓰기
- 서버가 아직 식별하지 않은 새 리소스 생성
    - 신규 주문 생성
- 기존 자원에 데이터 추가
    - 내용 추가
- URI에 POST 요청이 오면 요청 데이터를 어떻게 처리할지 리소스마다 따로 정해야 한다.

정리

- 새 리소스 생성
- 요청 데이터 처리
    - POST /paper/{id}/write (컨트롤 URI)
- 다른 메서드로 처리하기 애매한 경우

### PUT

파일을 복사하는 것이랑 비슷(기존에 파일이 있으면 덮어버림)

- 리소스를 대체
    - 리소스가 있으면 대체
    - 리소스가 없으면 생성
    - 클라이언트가 리소스 위치를 알고 URI 지정
    - POST와 차이
- **리소스를 알고있다!!!!!!**
- **리소스를 완전히 대체한다!!!!**
    - 기존 리소스가 삭제되고 대체된다.

### PATCH

기존 데이터를 부분적으로 변경

### DELETE

리소스 제거

### HTTP 메서드 속성

**안전**

- 호출해도 리소스를 변경하지 않는다. GET

**멱등**

- 여러번 호출해도 결과가 같다.
- GET, PUT, DELETE
- POST는 아님!!!
- 멱등은 외부 요인으로 중간에 리소스가 변경되는 것까지 고려하지 않는다.

**캐시가능**

- GET, HEAD 정도만 캐시로 사용
- POST, PATCH는 본문까지 캐시 키로 고려해야되는데 쉽지 않다.
